<!DOCTYPE html> 
<html> 
   <head> 
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
   <title>Metro Mobile</title>
   <link rel="stylesheet" href="css/mobile.css" />

   <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
<script>

   $(document).ready(function () {	
	$('nav li a').click(function(){
		var id = $(this).attr('id');
		readlist(id);
	})
	
	
	
	var nid = getURLParameters('nid');
	readarticle(nid);
	facebook(nid);
});


function getURLParameters(paramName) 
{
        var sURL = window.document.URL.toString();  
    if (sURL.indexOf("?") > 0)
    {
       var arrParams = sURL.split("?");         
       var arrURLParams = arrParams[1].split("&");      
       var arrParamNames = new Array(arrURLParams.length);
       var arrParamValues = new Array(arrURLParams.length);     
       var i = 0;
       for (i=0;i<arrURLParams.length;i++)
       {
        var sParam =  arrURLParams[i].split("=");
        arrParamNames[i] = sParam[0];
        if (sParam[1] != "")
            arrParamValues[i] = unescape(sParam[1]);
        else
            arrParamValues[i] = "No Value";
       }

       for (i=0;i<arrURLParams.length;i++)
       {
                if(arrParamNames[i] == paramName){
            //alert("Param:"+arrParamValues[i]);
                return arrParamValues[i];
             }
       }
       return "No Parameters Found";
    }

}

function facebook(nid){
		var feed = 'http://www.metro.co.tt/mobile/nodes/' + nid;
	$.ajax({
	  dataType: 'jsonp',
	  url: feed,
	  success: function (data) {
			$('#content').append('<div class="fb-like" data-href="'+ data.path + '" data-send="false" data-layout="button_count" data-width="100" data-show-faces="false" data-font="arial"></div>').delay(2800);
		  }
	});
}

function readarticle(nid){
	var feed = 'http://www.metro.co.tt/mobile/article?nid=' + nid;
	var output = '<div id="article">';
	$.ajax({
	  dataType: 'jsonp',
	  url: feed,
	  success: function (data) {
			$.each( data, function( key, value ) {
			output = output + '<div id="media"><div class="node-image">' + value.image + '</div>';
			output = output + '<div class="node-image-caption">' + value.caption + '</div></div>';
			output = output + '<div class="node-title"><h2>' + value.node_title + '</h2></div>';
			output = output + '<div class="node-author"><h5>' + value.author + '</h5></div>';
			output = output + '<div class="node-date"><h5>' + value.date + '</h5></div>';
			output = output + '<div class="node-body">'+ value.body + '</div>';		
		}); 
		output = output + '</div>';
		$('#content').append(output);
	  }
	});
	
}

function readlist(cat){
	
	var feed = 'http://www.metro.co.tt/mobile/' + cat;
	var output = '<div>';
	$.ajax({
	  dataType: 'jsonp',
	  url: feed,
	  success: function (data) {
		$.each( data, function( key, value ) {
			//$('#result_table').html(data[0].node_title);
			//$('#result_table').append(value.node_title + '<br />');
			output = output + '<a class="item" href="article.html?nid=' + value.nid + '"><div class="node-image">' + value.Image + '</div>';
			output = output + '<div class="node-title"><h1>' + value.node_title + '</h1></div>';
			output = output + '<div class="node-date">' + value.Date + '</div>';
			output = output + '<div class="node-teaser">' + value.teaser + '</div></a>';
			
		}); 
		
		output = output + '</div>';
		$('#content').html(output);
	  }
	});
}
</script>
   
</head> 
<body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div id="page">
   <header>
     <h1><img src="http://www.metro.co.tt/sites/all/themes/responsive_blog/logo.png" width="250" height="auto"></h1>
   </header>
   <nav>
   		<ul>
        <li class="first"><a id="spotlight" >Spotline</a></li>
        <li><a id="culture">Culture</a></li>
        <li><a id="lifestyle">Lifestyle</a></li>
        <li class="last"><a id="sports">Sport Line</a></li>
        </ul>
   </nav>
   <!-- /header -->
   <div id="content">

  </div>
<footer>
      <h4>Metro &copy 2013 </h4>
</footer>
</div>  

</body>
</html>